{% extends "base.html" %}
{% block title %}Login ‚Äî Timetable Expert{% endblock %}

{% block content %}
<div class="min-h-[70vh] flex items-center justify-center">
  <div class="w-full max-w-md">
    <div class="text-center mb-6">
      <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white">Welcome back</h2>
      <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">Sign in to your account</p>
    </div>

    <div class="bg-white dark:bg-gray-800 py-8 px-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
      <form method="POST" action="{{ url_for('auth.login') }}" id="loginForm" class="space-y-6">
        {{ (form.hidden_tag() if form is defined else '') | safe }}

        <div>
          {{ (form.email.label(class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2") if form is defined else '') | safe }}
          {{ (form.email(id="email", class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-white") if form is defined else '<input id=\"email\" name=\"email\" placeholder=\"Email\" class=\"w-full px-4 py-3 border rounded-lg\"/>') | safe }}
        </div>

        <div>
          {{ (form.password.label(class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2") if form is defined else '') | safe }}
          <div class="relative">
            {{ (form.password(id="password", class="w-full px-4 py-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-white") if form is defined else '<input id=\"password\" name=\"password\" type=\"password\" placeholder=\"Password\" class=\"w-full px-4 py-3 border rounded-lg\"/>') | safe }}
            <button type="button" id="togglePassword" class="absolute inset-y-0 right-0 pr-3 text-gray-400">üëÅ</button>
          </div>
        </div>

        <div class="flex items-center justify-between">
          <label class="text-sm text-gray-600 dark:text-gray-400"><input type="checkbox" class="mr-2"> Remember me</label>
          <a href="#" class="text-sm text-primary-500">Forgot password?</a>
        </div>

        <div>
          <button id="submitBtn" type="submit" disabled
                  class="w-full flex items-center justify-center gap-2 py-3 rounded-md bg-primary-500 hover:bg-primary-600 text-white font-medium disabled:opacity-60 disabled:cursor-not-allowed">
            <!-- lock icon -->
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2z"/></svg>
            <span>{{ (form.login.label.text if form is defined else 'Login') }}</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function(){
    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const toggle = document.getElementById('togglePassword');
    const submitBtn = document.getElementById('submitBtn');
    const form = document.getElementById('loginForm');

    // show/hide password
    if (toggle && password) {
      toggle.addEventListener('click', () => {
        password.type = (password.type === 'password') ? 'text' : 'password';
        toggle.textContent = (password.type === 'password') ? 'üëÅ' : 'üôà';
      });
    }

    // enable button only when fields filled
    function validate(){ submitBtn.disabled = !(email && email.value.trim() && password && password.value.trim()); }
    form.addEventListener('input', validate);
    validate();
  });
</script>
{% endblock %}
